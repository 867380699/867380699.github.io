---

layout: post
title: "代码整洁之道"
date: 2021-03-04

---

# 有意义的命名
- 使用**读得出来**的名称
- 使用**可搜索**的名称

专业的程序员了解，明确才是王道。


方法名应当是动词或动词短语，如 `postPayment`, `deletePage`, `save`。

每个概念对应一个词

反例： 同时使用 `controller`, `manager`, `driver`。

记住，只有程序员才会读你的代码。

# 函数

## 短小
函数的第一规则是要短小。第二规则是还要更短小。

`if`, `else`, `while` 等，其中的代码块应该只有一行。 *(很极端...)*

## 分层

每个函数一个抽象层级

长而具有描述性的名称，比描述性的长注释要好。

命名约定

命名方式要保持一致

`includeSetupAndTeardownPages`、`includeSetupPage`、`includeSuiteSetupPage`...

## 函数参数

最理想的参数数量是零，其次是一，再次是二，应尽量避免三。

从测试的角度看，参数多难于测试。*(条件覆盖率)*

### 标识参数

标识参数丑陋不堪。

向函数传入布尔值兼职就是骇人听闻的做法。

这样做，方法签名立刻变得复杂，大声宣布函数不止做一件事。

### 二元函数

两个参数通常没有自然顺序 `assetEqual(expected, actual)` 中， `expected` 在前， `actual` 在后， 只是一种需要学习的约定罢了。

### 参数对象

```java
Circle makeCircle(double x, double y, double radius);
Circle makeCircle(Point center, double radius);
```

## 无副作用

时序性耦合

```java
appendFooter(s);
```
这个函数式把 `s` 添加到什么东西后面吗？或是把什么东西添加到了 `s` 的后面？

面向对象:

```java
report.appendFooter();
```

## 分隔指令与询问

函数要么做什么事，要么回答什么事，单二者不可得兼。

## 使用异常代替返回错误码

函数应该只做一件事情。错误处理就是一件事情。

## Don't Repeat Youself.

# 注释

> 别给糟糕的代码加注释——重新写吧！

注释并不纯然的好，实际上，注释最多也就是一种必须的恶。

注释的恰当用法是弥补我们在用代码表达意图时遭遇的失败。

注释存在的时间越久，就离其所描述的代码越远，原因很简单，程序员不能坚持维护注释。

## 注释不能美化糟糕的代码

所谓每个函数都要有 Javadoc 或是每个变量都要有注释全然是愚蠢可笑的。

能用函数或变量时就别用注释。

# 格式

保持良好的代码格式。
选用一套管理代码格式的简单规则并贯彻这些规则。

今天编写的功能，极有可能在下一版本中被修改，但代码的可读性却会对以后可能发生的修改行为产生深远的影响。
原始代码修改之后很久，其代码风格和可读性仍会影响到可维护性和扩展性。
即便代码已不复存在，你的风格和律条仍然存活了下来。

## 垂直格式

### 向报纸学习
想想看写得好的报纸文章。你从上到下阅读。
在顶上，你期望有个头条，告诉你故事主题。
第一段是整个故事的大纲，给出粗线条概述，但隐藏了故事细节。
接着读下去，细节渐次增加，直至你了解所有其他细节。

报纸由许多文章组成，多数短小精悍，有的稍微长点，很少有占满一整页的。

### 垂直间隔
不同概念间的空白行。

### 垂直距离
关系密切的概念应该互相靠近。

变量声明应尽可能靠近其使用的位置。

因为函数很短，本地变量应该在函数的顶部出现。

实体变量应该在类的顶部声明，因为在设计良好的类中，它们会被大部分类使用。

相关函数

若某个函数调用了了另一个函数，就应该把它们放到一起，而且调用者应尽可能在被调用者前面。


